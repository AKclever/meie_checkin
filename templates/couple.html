{% extends "base.html" %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<h2>Meie mõlema graafik</h2>
<canvas id="coupleChart"></canvas>
<script>
  const labels = {{ labels | tojson }};
  const series = {{ series | tojson }};

  const datasets = Object.keys(series).map((name, idx) => ({
    label: name,
    data: series[name],
    tension: 0.3
  }));

  const ctx = document.getElementById('coupleChart');
  new Chart(ctx, {
    type: 'line',
    data: { labels, datasets },
    options: { scales: { y: { suggestedMin: 0, suggestedMax: 10 } } }
  });
</script>

<h3>Ühine tabel</h3>
<table>
  <tr>
    <th>Nädal</th>
    {% for name in series.keys() %}
      <th>{{ name }}</th>
    {% endfor %}
  </tr>
  {% for label in labels %}
    <tr>
      <td>{{ label }}</td>
      {% for name, values in series.items() %}
        <td>{{ values[loop.parentloop.index0] if values[loop.parentloop.index0] is not none else "-" }}</td>
      {% endfor %}
    </tr>
  {% endfor %}
</table>
{% endblock %}
